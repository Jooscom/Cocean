<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC	"-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd"
>
<mapper namespace="kr.co.cocean.schedule.dao.ScheduleDAO">	
	
	

	
	<insert id="scheduleWrite" useGeneratedKeys="true" keyColumn="scheduleID"
		keyProperty="scheduleID" parameterType="schedule">
		INSERT INTO schedule VALUES(NULL,#{employeeID},#{title},#{start},#{end},#{subCategory},#{description},#{remarks},#{publicCategory},#{backgroundColor});
	</insert>
	
	<select id="getCallenderEvents">
		SELECT title,start,end,backgroundColor,subCategory FROM schedule s WHERE employeeID = #{employeeID} AND subCategory='개인';
	</select>
	
	<select id="addInterestCallender">
		SELECT title, start, end, backgroundColor, subCategory,CONCAT(e.name, ' ', p.positionName) AS name
		FROM schedule s
		JOIN employee e ON e.employeeID = s.employeeID
		JOIN `position` p ON e.positionID = p.positionID 
		WHERE s.employeeID = #{employeeID} AND s.subCategory = '개인';
	</select>
	
	<select id="getFacilityEvents">
		SELECT title,start,end,backgroundColor,subCategory FROM schedule s WHERE subCategory ='예약';
	</select>
	
	<select id="getFacility">
		SELECT  facilityName FROM facility f  WHERE category=#{text} AND isUse=0;
	</select>
	
	<insert id="facilityWrite" useGeneratedKeys="true" keyColumn="scheduleID"
		keyProperty="scheduleID" parameterType="schedule">
		INSERT INTO schedule values(NULL,#{employeeID},#{title},#{start},#{end},'예약',#{description},'-','1',#{backgroundColor});
	</insert>
	
	<update id="updateFacility">
		update facility SET isUSE='1' WHERE facilityName = #{facilityName}
	</update>
	
	<insert id="addCalender" parameterType="String">
	INSERT INTO calendar(employeeID,calendarName) VALUES (#{loginEmployeeID}, CONCAT(#{nodeText}, '님의 캘린더'));
	</insert>
	
	<select id="showInterestCalendar">
		SELECT calendarName from calendar where employeeID = #{loginEmployeeID};
	</select>
</mapper>